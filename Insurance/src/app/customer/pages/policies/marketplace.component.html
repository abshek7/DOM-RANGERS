<div class="marketplace-container">
    <div class="marketplace-header">
        <h1>Browse Insurance Policies</h1>
        <p>Find the perfect insurance plan for your needs</p>
    </div>

    <!-- Search and Filter -->
    <div class="search-filter-section">
        <div class="search-box">
            <span class="search-icon">üîç</span>
            <input type="text" placeholder="Search policies..." [(ngModel)]="searchTerm"
                (ngModelChange)="onSearchChange()" />
        </div>

        <div class="filter-box">
            <label>Filter by Type:</label>
            <select [(ngModel)]="selectedType" (ngModelChange)="onTypeChange()">
                <option *ngFor="let type of policyTypes" [value]="type">
                    {{ type === 'all' ? 'All Types' : type }}
                </option>
            </select>
        </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading-state">
        <div class="spinner"></div>
        <p>Loading policies...</p>
    </div>

    <!-- Policies Grid -->
    <div *ngIf="!loading" class="policies-grid">
        <div *ngFor="let policy of filteredPolicies" class="policy-card">
            <div class="policy-header">
                <div class="policy-icon">{{ policy.icon }}</div>
                <div class="policy-type-badge">{{ policy.type }}</div>
            </div>

            <h3>{{ policy.policyName }}</h3>
            <p class="policy-description">{{ policy.description }}</p>

            <div class="policy-stats">
                <div class="stat">
                    <span class="stat-label">Premium</span>
                    <span class="stat-value">‚Çπ{{ policy.premium | number }}</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Coverage</span>
                    <span class="stat-value">‚Çπ{{ policy.coverage | number }}</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Duration</span>
                    <span class="stat-value">{{ policy.duration }}</span>
                </div>
            </div>

            <div class="policy-features">
                <div *ngFor="let feature of policy.features.slice(0, 3)" class="feature-item">
                    <span class="check-icon">‚úì</span>
                    {{ feature }}
                </div>
            </div>

            <div class="policy-rating">
                <div class="stars">
                    <span *ngFor="let star of getStarArray(policy.rating)" class="star">‚≠ê</span>
                </div>
                <span class="rating-text">{{ policy.rating }} ({{ policy.reviewCount }} reviews)</span>
            </div>

            <div class="policy-actions">
                <button class="btn-secondary" [routerLink]="['/customer/policy-details', policy.id]">
                    View Details
                </button>
                <button class="btn-primary" [routerLink]="['/customer/purchase', policy.id]">
                    Buy Now
                </button>
            </div>
        </div>

        <!-- No Results -->
        <div *ngIf="filteredPolicies.length === 0" class="no-results">
            <span class="no-results-icon">üîç</span>
            <h3>No policies found</h3>
            <p>Try adjusting your search or filter criteria</p>
        </div>
    </div>
</div>